if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("MercuryAudioType",[],(function(a,b,c,d,e,f){e.exports={FileAttachment:"file_attachment",AudioClip:"fb_voice_message",VoiceMessageWithTranscript:"fb_voice_message_with_transcript"}}),null);
__d("MessagingTag",[],(function(a,b,c,d,e,f){e.exports={ACTION_ARCHIVED:"action:archived",INBOX:"inbox",MARKETPLACE_FOLDER:"marketplace_folder",PENDING:"pending",MONTAGE:"montage",OTHER:"other",EVENT:"event",SENT:"sent",SPAM:"spam",UPDATES:"broadcasts_inbox",BCC:"header:bcc",FILTERED_CONTENT:"filtered_content",FILTERED_CONTENT_BH:"filtered_content_bh",FILTERED_CONTENT_ACCOUNT:"filtered_content_account",FILTERED_CONTENT_QUASAR:"filtered_content_quasar",FILTERED_CONTENT_INVALID_APP:"filtered_content_invalid_app",UNAVAILABLE_ATTACHMENT:"unavailable_attachment",UNREAD:"unread",FLAGGED:"flagged",GROUPS:"groups",TRANSITIONAL_MAILBOX:"transitional_mailbox",ARCHIVED:"archived",EMAIL:"email",VOICEMAIL:"voicemail",SPAM_SPOOFING:"spam:spoofing",SPOOF_WARNING:"MTA:spoof_warning",SMS_TAG_ROOT:"SMSShortcode:",APP_ID_ROOT:"app_id:",DOMAIN_AUTH_PASS:"MTA:dmarc:pass",DOMAIN_AUTH_FAIL:"MTA:dmarc:fail",MTA_SYSTEM_MESSAGE:"MTA:system_message",EMAIL_MESSAGE:"source:email",MARKETPLACE:"marketplace",BC_PARTNERSHIP:"bc_partnership",ROOM:"room",PAGES:"pages",PAGE_BACKGROUND:"page_background",PAGE_FOLLOWUP:"page_followup",ONE_CLICK_MESSAGE:"page_one_click_message",MESSAGE_REQUEST_AGGREGATION_UNIT:"message_request_aggregation_unit",ONE_WAY_MESSAGE:"one_way_message",ACTION_COPIED_MESSAGE:"action:copy_message",ACTION_COPIED_SELF_MESSAGE:"copy_self_message",ACTION_COPIED_ATTACHMENT:"action:copy_attachment",ACTION_COPIED_SELF_ATTACHMENT:"copy_self_attachment",STORY_REPLY:"story_reply",IRIS_MAPPING:{FOLDER_INVALID:null,FOLDER_INBOX:"inbox",FOLDER_OTHER:"other",FOLDER_SPAM:"spam",FOLDER_PENDING:"pending",FOLDER_MONTAGE:"montage",FOLDER_HIDDEN:"hidden",FOLDER_DISABLED:"disabled",FOLDER_PAGE_BACKGROUND:"page_background",FOLDER_PAGE_DONE:"page_done",FOLDER_BLOCKED:"blocked",FOLDER_COMMUNITY:"community",FOLDER_RESTRICTED:"restricted",FOLDER_BC_PARTNERSHIP:"bc_partnership",FOLDER_E2EE_CUTOVER:"e2ee_cutover"}}}),null);
__d("XAddToHomescreenRegistrationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/a2hs/state/",{})}),null);
__d("AddToHomeScreenRegistration",["MRequest","PushRegistration","Run","ServiceWorkerRegistration","XAddToHomescreenRegistrationController"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var d=c("XAddToHomescreenRegistrationController").getURIBuilder().getURI();new(c("MRequest"))(d).setMethod("POST").addData({event:a,prompt_type:b}).setIgnoreErrors(!0).send()}function a(a){d("Run").onAfterLoad(function(){c("ServiceWorkerRegistration").registerWorkerIfUnregistered(a)})}function i(){if(c("PushRegistration").pushPermissionIsOn())return;c("ServiceWorkerRegistration").unregisterControllingWorker()}function b(a,b){h(a,b),a==="prompt_rejected"&&i()}g.register=a;g.unregister=i;g.onInstallBanner=b}),98);
__d("MercuryAttachmentSnippetType",["keyMirror"],(function(a,b,c,d,e,f,g){a=c("keyMirror")({PHOTO:null,GIF:null,VIDEO:null,AUDIO_CLIP:null,STICKER:null,SHARE:null,ERROR:null,MIXED:null,GIFT:null,THIRDPARTYSTICKER:null,FILE:null,LIKE_STICKER:null});b=a;g["default"]=b}),98);
__d("MercuryGiftSnippetRenderer",["fbt","react"],(function(a,b,c,d,e,f,g,h){"use strict";d("react");function a(a,b){return a?h._("You sent a valentine."):h._("{name} sent a valentine.",[h._param("name",b)])}g.renderText=a}),98);
__d("MessengerLightweightActionUtils",[],(function(a,b,c,d,e,f){"use strict";function g(a){return!!(a&&a.attach_type==="share"&&a.share&&a.share.target&&a.share.target.lwa_type)}function a(a){a=a==null?void 0:a.attachments;return!!(a&&a.length===1&&g(a[0]))}function b(a){return a.attachments[0].share.title}function c(a){return a[0].share.title}f.isLWAAttachment=g;f.isLWAMessage=a;f.getCollapsedLWAText=b;f.getLWASnippetText=c}),66);
__d("P2PSnippetStringUtils",["fbt","react"],(function(a,b,c,d,e,f,g,h){d("react");function i(a,b,c,d,e){if(a)return h._("Your request for {payment request amount} from {receiver's name} was canceled.",[h._param("payment request amount",e),h._param("receiver's name",d)]);else if(b)return h._("{requester's name}'s request for {payment request amount} was canceled.",[h._param("requester's name",c),h._param("payment request amount",e)]);else return h._("{requester's name}'s request for {payment request amount} from {receiver's name} was canceled.",[h._param("requester's name",c),h._param("payment request amount",e),h._param("receiver's name",d)])}function j(a,b,c,d,e){if(a)return h._("{receiver's name} declined your request for {payment request amount}.",[h._param("receiver's name",d),h._param("payment request amount",e)]);else if(b)return h._("You declined {requester's name}'s request for {payment request amount}.",[h._param("requester's name",c),h._param("payment request amount",e)]);else return h._("{receiver's name} declined {sender's name}'s request for {payment request amount}.",[h._param("receiver's name",d),h._param("sender's name",c),h._param("payment request amount",e)])}function k(a,b,c,d,e){if(a)return h._("You requested {amount} from {requestee name}.",[h._param("amount",e),h._param("requestee name",d)]);else if(b)return h._("{requester name} requested {amount} from you.",[h._param("requester name",c),h._param("amount",e)]);else return h._("{name} requested {amount} from {requestee name}.",[h._param("name",c),h._param("amount",e),h._param("requestee name",d)])}function a(a,b,c,d,e,f){a=a||1;b=[b,c,d,e,f];switch(a){case 2:return j.apply(void 0,b);case 5:case 6:return i.apply(void 0,b)}return k.apply(void 0,b)}function l(a,b,c,d,e){if(a)return h._("Your {amount} payment to {receiver_name} was canceled.",[h._param("amount",e),h._param("receiver_name",d)]);else if(b)return h._("{sender name}'s {amount} payment was canceled.",[h._param("sender name",c),h._param("amount",e)]);else return h._("{sender_name}'s {amount} payment to {receiver_name} was canceled.",[h._param("sender_name",c),h._param("amount",e),h._param("receiver_name",d)])}function m(a,b,c,d,e){if(a)return h._("{receiver_name} didn't accept your {amount} payment.",[h._param("receiver_name",d),h._param("amount",e)]);else if(b)return h._("You didn't accept {sender name}'s {amount} payment.",[h._param("sender name",c),h._param("amount",e)]);else return h._("{receiver_name} didn't accept {sender_name}'s {amount} payment.",[h._param("receiver_name",d),h._param("sender_name",c),h._param("amount",e)])}function n(a,b,c,d,e){if(a)return h._("You sent {receiver name} {amount}.",[h._param("receiver name",d),h._param("amount",e)]);else if(b)return h._("{name} sent you {amount}.",[h._param("name",c),h._param("amount",e)]);else return h._("{sender name} sent {receiver name} {amount}.",[h._param("sender name",c),h._param("receiver name",d),h._param("amount",e)])}function b(a,b,c,d,e,f){b=[b,c,d,e,f];c=a||15;switch(c){case 5:return m.apply(void 0,b);case 3:case 10:case 11:case 12:case 16:return l.apply(void 0,b)}return n.apply(void 0,b)}g.getRequestCanceledSnippet=i;g.getRequestDeclinedSnippet=j;g.getRequestSentSnippet=k;g.getRequestSnippetByStatus=a;g.getTransferCanceledSnippet=l;g.getTransferDeclinedSnippet=m;g.getTransferSentSnippet=n;g.getTransferSnippetByStatus=b}),98);
__d("StickerConstants",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({MOBILE_LIKE_STICKER_PACK_ID:"227877430692340",GRAVEYARD_PACK_ID:"604597256247273",LIKE_STICKER_ID:"227878347358915",HOT_LIKE_SMALL_STICKER_ID:"369239263222822",HOT_LIKE_MEDIUM_STICKER_ID:"369239343222814",HOT_LIKE_LARGE_STICKER_ID:"369239383222810",MRU_STICKER_PACK:"599061016853145",SEARCH_PACK_ID:"680229632032514",FEED_PACK_ID:"2239834712900285",OZ_PACK_ID:"1456625217993235",AVATARS_PACK_ID:"2191329907595522",TRENDING_STICKER_PACK_ID:"924487421216423",SPRITE_PADDING:"24",PayloadSource:{VIEW_ACTION:"view-action"},DEFAULT_FRAME_RATE:83,TRAY_SIZE:64,THREAD_SIZE:120})}),null);
__d("MercuryAttachmentSnippetRenderer",["fbt","CurrentUser","MercuryAttachmentSnippetType","MercuryAudioType","MercuryGiftSnippetRenderer","MessengerLightweightActionUtils","P2PSnippetStringUtils","StickerConstants","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||b("react");var i={getAttachmentSnippetType:function(a){if(i._hasOnlyPhotos(a))return b("MercuryAttachmentSnippetType").PHOTO;if(i._hasOnlyAnimatedImages(a))return b("MercuryAttachmentSnippetType").GIF;if(i._hasOnlyVideo(a))return b("MercuryAttachmentSnippetType").VIDEO;if(i._hasAudioClip(a))return b("MercuryAttachmentSnippetType").AUDIO_CLIP;if(i._hasLikeSticker(a))return b("MercuryAttachmentSnippetType").LIKE_STICKER;if(i._hasSticker(a))return b("MercuryAttachmentSnippetType").STICKER;if(i._hasThirdPartySticker(a))return b("MercuryAttachmentSnippetType").THIRDPARTYSTICKER;if(i._hasShare(a))return b("MercuryAttachmentSnippetType").SHARE;if(i._hasGift(a))return b("MercuryAttachmentSnippetType").GIFT;if(i._hasError(a))return b("MercuryAttachmentSnippetType").ERROR;return i._hasFile(a)?b("MercuryAttachmentSnippetType").FILE:b("MercuryAttachmentSnippetType").MIXED},renderAttachmentSnippetText:function(a,c,d,e){switch(a){case b("MercuryAttachmentSnippetType").PHOTO:return i._renderPhotoAttachmentSnippetText(c,d,i._getPhotoAttachments(e));case b("MercuryAttachmentSnippetType").GIF:return i._renderAnimatedImagesAttachmentSnippetText(c,d,i._getAnimatedImageAttachments(e));case b("MercuryAttachmentSnippetType").VIDEO:return c?g._("You sent a video."):g._("{sender name} sent a video.",[g._param("sender name",d)]);case b("MercuryAttachmentSnippetType").AUDIO_CLIP:return c?g._("You sent a voice message."):g._("{name} sent a voice message.",[g._param("name",d)]);case b("MercuryAttachmentSnippetType").STICKER:case b("MercuryAttachmentSnippetType").LIKE_STICKER:case b("MercuryAttachmentSnippetType").THIRDPARTYSTICKER:return c?g._("You sent a sticker."):g._("{name} sent a sticker.",[g._param("name",d)]);case b("MercuryAttachmentSnippetType").SHARE:if(e&&i._hasP2PPayment(e))return i._renderP2PPaymentSnippetText(e[0]);if(e&&i._hasP2PPaymentRequest(e))return i._renderP2PPaymentRequestSnippetText(e[0]);if(e&&i._hasBusinessMessage(e))return i._renderBusinessMessageSnippetText(e[0],d);if(e&&i._hasLocation(e))return c?g._("You sent a location."):g._("{sender name} sent a location.",[g._param("sender name",d)]);if(e&&i._hasLiveLocation(e))return c?g._("You sent a live location."):g._("{sender name} sent a live location.",[g._param("sender name",d)]);if(e&&i._hasMontageDirect(e)){a=e[0];a=(a=a)!=null?(a=a.share)!=null?(a=a.media)!=null?a.source:a:a:a;return c?a?g._("You sent a video."):g._("You sent a photo."):a?g._("View {sender name}'s disappearing video.",[g._param("sender name",d)]):g._("View {sender name}'s disappearing photo.",[g._param("sender name",d)])}if(e&&e.length===1&&b("MessengerLightweightActionUtils").isLWAAttachment(e[0]))return b("MessengerLightweightActionUtils").getLWASnippetText(e);return e&&e.length===1&&i._isGloballyRemovedMessageAttachment(e[0])?e[0].share.description:c?g._("You sent a link."):g._("{sender name} sent a link.",[g._param("sender name",d)]);case b("MercuryAttachmentSnippetType").GIFT:return b("MercuryGiftSnippetRenderer").renderText(c,d);case b("MercuryAttachmentSnippetType").FILE:return c?g._("You sent an attachment."):g._("{sender name} sent an attachment.",[g._param("sender name",d)]);case b("MercuryAttachmentSnippetType").MIXED:return c?g._("You sent some attachments."):g._("{sender name} sent some attachments.",[g._param("sender name",d)]);case b("MercuryAttachmentSnippetType").ERROR:return c?g._("You sent an attachment."):g._("{sender name} sent an attachment.",[g._param("sender name",d)]);default:return""}},_isGloballyRemovedMessageAttachment:function(a){return a.share&&a.share.style_list&&a.share.style_list.includes("globally_deleted_message_placeholder")},_hasOnlyPhotos:function(a){return i._getPhotoAttachments(a).length===a.length},_hasThirdPartySticker:function(a){return a.length===1&&a[0].attach_type==="third_party_sticker"},_hasOnlyAnimatedImages:function(a){return i._getAnimatedImageAttachments(a).length===a.length},_hasOnlyVideo:function(a){return a.length===1&&a[0].attach_type==="video"},_hasAudioClip:function(a){var c=a[0].metadata&&a[0].metadata.type;return a.length===1&&(c===b("MercuryAudioType").AudioClip||c===b("MercuryAudioType").VoiceMessageWithTranscript)},_hasBusinessMessage:function(a){return i._hasSingleShareAttachmentOfStyle(a,"business_message_items")},_hasSticker:function(a){return a.length===1&&a[0].attach_type==="sticker"},_hasLikeSticker:function(a){if(a.length<1)return!1;var c=a[0].metadata&&a[0].metadata.stickerID;return a.length===1&&(c==b("StickerConstants").LIKE_STICKER_ID||c==b("StickerConstants").HOT_LIKE_SMALL_STICKER_ID||c==b("StickerConstants").HOT_LIKE_MEDIUM_STICKER_ID||c==b("StickerConstants").HOT_LIKE_LARGE_STICKER_ID)},_hasLocation:function(a){return i._hasSingleShareAttachmentOfStyle(a,"message_location")},_hasLiveLocation:function(a){return i._hasSingleShareAttachmentOfStyle(a,"message_live_location")},_hasMontageDirect:function(a){return i._hasSingleShareAttachmentOfStyle(a,"montage_direct")},_hasP2PPayment:function(a){return i._hasSingleShareAttachmentOfStyle(a,"orion")},_hasP2PPaymentRequest:function(a){return i._hasSingleShareAttachmentOfStyle(a,"orion_request")},_hasSingleShareAttachmentOfStyle:function(a,b){return a.length===1&&a[0].attach_type==="share"&&a[0].share&&a[0].share.style_list.indexOf(b)>=0},_hasShare:function(a){return a.length===1&&a[0].attach_type==="share"},_hasError:function(a){return a.length===1&&a[0].attach_type==="error"},_hasGift:function(a){return a.length===1&&a[0].attach_type==="gift"},_hasFile:function(a){return a.length===1&&a[0].attach_type==="file"},_getPhotoAttachments:function(a){return!a?[]:a.filter(function(a){return a.attach_type==="photo"})},_getAnimatedImageAttachments:function(a){return!a?[]:a.filter(function(a){return a.attach_type==="animated_image"})},_renderPhotoAttachmentSnippetText:function(a,b,c){if(c.length===1)if(a)return g._("You sent a photo.");else return g._("{name} sent a photo.",[g._param("name",b)]);else if(a)return g._({"*":"You sent {num_photos} photos."},[g._param("num_photos",c.length,[0])]);else return g._({"*":"{name} sent {num_photos} photos."},[g._param("num_photos",c.length,[0]),g._param("name",b)])},_renderAnimatedImagesAttachmentSnippetText:function(a,b,c){if(c.length===1)if(a)return g._("You sent a GIF.");else return g._("{name} sent a GIF.",[g._param("name",b)]);else if(a)return g._("You sent {num_animated_images} GIFs.",[g._param("num_animated_images",c.length)]);else return g._("{name} sent {num_animated_images} GIFs.",[g._param("name",b),g._param("num_animated_images",c.length)])},_renderBusinessMessageSnippetText:function(a,b){a=a.share.target;a=a&&a.message||g._("{sender name} sent an attachment.",[g._param("sender name",b)]);return a},_renderP2PPaymentSnippetText:function(a){a=a.share.target;return i.renderP2PPaymentSnippetText(b("CurrentUser").getID()===a.sender.id,a.sender.name,a.amountWithSymbol,a.status,b("CurrentUser").getID()===a.receiver.id,a.receiver.name)},_renderP2PPaymentRequestSnippetText:function(a){a=a.share.target;return i.renderP2PPaymentRequestSnippetText(b("CurrentUser").getID()===a.requester.id,a.requester.name,a.amountWithSymbol,a.currentStatus,b("CurrentUser").getID()===a.requestee.id,a.requestee.name)},renderP2PPaymentSnippetText:function(a,c,d,e,f,g){return b("P2PSnippetStringUtils").getTransferSnippetByStatus(e,a,f||!1,c||"",g||"",d)},renderP2PPaymentRequestSnippetText:function(a,c,d,e,f,g){return b("P2PSnippetStringUtils").getRequestSnippetByStatus(e,a,f||!1,c||"",g||"",d)}};e.exports=i}),null);
__d("P2PPaymentRequestStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({INITED:1,DECLINED:2,TRANSFER_INITED:3,TRANSFER_COMPLETED:4,TRANSFER_FAILED:5,CANCELED:6,EXPIRED:7,MANUALLY_MARKED_AS_COMPLETED:8});f["default"]=a}),66);
__d("P2PTransferStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({SYSTEM_FAILURE:0,PENDING_SENDER_MANUAL_REVIEW:1,PENDING_SENDER_VERIFICATION:2,CANCELED_SENDER_RISK:3,PENDING_RECIPIENT_NUX:4,CANCELED_DECLINED:5,PENDING_RECIPIENT_VERIFICATION:6,PENDING_RECIPIENT_MANUAL_REVIEW:7,PENDING_RECIPIENT_PROCESSING:8,PENDING_PUSH_FAIL:9,CANCELED_RECIPIENT_RISK:10,CANCELED_SYSTEM_FAIL:11,CANCELED_EXPIRED:12,COMPLETED:13,INTERMEDIATE_PROCESSING:14,PENDING_SENDER_INITED:15,CANCELED_SAME_CARD:16,PENDING_SENDER_VERIFICATION_PROCESSING:17,PENDING_RECIPIENT_VERIFICATION_PROCESSING:18,CANCELED_SENDER_CANCEL:19,PENDING_SENDER_IDV_REVIEW:20,PENDING_RECEIVER_IDV_REVIEW:21});f["default"]=a}),66);
__d("IntlDateStringsTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:IntlDateStringsLoggerConfig")}),null);
__d("IntlDateFormatsCLDRWidthEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({FULL:"full",LONG:"long",MEDIUM:"medium",SHORT:"short"});f["default"]=a}),66);
__d("RegionDatetimePatterns",[],(function(a,b,c,d,e,f){a=Object.freeze({DATE_SHORT:"date_short",DATETIME_SHORT_SHORT:"dateTime_short_short",TIME_SHORT:"time_short",TIME_MEDIUM:"time_medium",J:"j"});f["default"]=a}),66);
__d("flipObject",[],(function(a,b,c,d,e,f){"use strict";function a(a){return Object.entries(a).reduce(function(b,c){var d=c[0];c=c[1];Object.prototype.hasOwnProperty.call(a,d)&&typeof c!=="object"&&typeof c!=="function"&&c!=null&&(b[String(c)]=d);return b},{})}f["default"]=a}),66);
__d("getCLDRLocalizedFormat",["CLDRDateFormatConfig","FBLogger","IntlDateFormatsCLDRWidthEnum","RegionDatetimePatterns","flipObject","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("CLDRDateFormatConfig").CLDRConfigeratorFormats,h=b("CLDRDateFormatConfig").CLDRRegionalConfigeratorFormats,i=b("flipObject")(b("RegionDatetimePatterns"));function a(a){if(a==null)throw b("unrecoverableViolation")('Format: "'+a+'", not supported by configurator.',"internationalization");var c,d,e=a.split("_"),f=e[0];e=e.slice(1);var l=f+"Formats";a in i?d=h:d=g;switch(l){case"dateFormats":case"timeFormats":var m=j(e[0]);if(m==null)throw b("unrecoverableViolation")('Format: "'+a+'", category: "'+l+'", with unsupported width: "undefined"',"internationalization");c=d[l][m];if(c==null)throw b("unrecoverableViolation")('Format: "'+a+'", category: "'+l+'", '+('width: "'+m+'", with unsupported localization'),"internationalization");break;case"dateTimeFormats":m=j(e[0]);e=j(e[1]);if(m==null||e==null)throw b("unrecoverableViolation")('Format: "'+a+'", category: "'+l+'", with unsupported width: dateFormatKey="undefined" timeFormatKey="undefined"',"internationalization");c=d[l][m];var n=d.dateFormats[m],o=d.timeFormats[e];if(c==null)throw b("unrecoverableViolation")('Format: "'+a+'", category: "'+l+'", '+('date width: "'+m+'", and time width: ')+('"'+e+'", with unsupported localization'),"internationalization");c=c.replace("{0}",o).replace("{1}",n);break;default:l="availableFormats";m=f;m.includes("j")&&(m=k(m,d.timeFormats));c=d[l][m];if(c==null)throw b("unrecoverableViolation")('Format: "'+a+'", with key: "'+m+'", not supported by CLDR',"internationalization")}return c}function j(a){if(a==null)throw b("unrecoverableViolation")("Expected CLDR width key to not be null","internationalization");return b("IntlDateFormatsCLDRWidthEnum")[a.toUpperCase()]}function k(a,c){var d;c=c["short"];c==null?(b("FBLogger")("formatDate").blameToPreviousFile().warn('CLDR `timeFormat`, width `short` required for 24 hour localization not found for availableKey: "%s"',a),d="h"):d=c.includes("H")?"H":"h";return a.replace("j",d)}e.exports=a}),null);
__d("intlGetDateNumerics",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){b=b.utc===!0;b?b={dateDay:a.getUTCDate(),dateDayOfWeek:a.getUTCDay(),dateMonth:a.getUTCMonth(),dateYear:a.getUTCFullYear(),dateHours:a.getUTCHours(),dateMinutes:a.getUTCMinutes(),dateSeconds:a.getUTCSeconds(),dateMilliseconds:a.getUTCMilliseconds()}:b={dateDay:a.getDate(),dateDayOfWeek:a.getDay(),dateMonth:a.getMonth(),dateYear:a.getFullYear(),dateHours:a.getHours(),dateMinutes:a.getMinutes(),dateSeconds:a.getSeconds(),dateMilliseconds:a.getMilliseconds()};return b}f["default"]=a}),66);
__d("DateStrings",["fbt"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q;function a(a){n||(n=[h._("Sunday"),h._("Monday"),h._("Tuesday"),h._("Wednesday"),h._("Thursday"),h._("Friday"),h._("Saturday")]);return n[a]}function b(a){p||(p=[h._("Sunday"),h._("Monday"),h._("Tuesday"),h._("Wednesday"),h._("Thursday"),h._("Friday"),h._("Saturday")]);return p[a]}function c(a){o||(o=[h._("Sun"),h._("Mon"),h._("Tue"),h._("Wed"),h._("Thu"),h._("Fri"),h._("Sat")]);return o[a]}function d(a){q||(q=[h._("SUN"),h._("MON"),h._("TUE"),h._("WED"),h._("THU"),h._("FRI"),h._("SAT")]);return q[a]}function r(){i=[h._("January"),h._("February"),h._("March"),h._("April"),h._("May"),h._("June"),h._("July"),h._("August"),h._("September"),h._("October"),h._("November"),h._("December")]}function e(a){i||r();return i[a-1]}function f(){i||r();return i.slice()}function s(a){l||(l=[h._("January"),h._("February"),h._("March"),h._("April"),h._("May"),h._("June"),h._("July"),h._("August"),h._("September"),h._("October"),h._("November"),h._("December")]);return l[a-1]}function t(a){j||(j=[h._("Jan"),h._("Feb"),h._("Mar"),h._("Apr"),h._("May"),h._("Jun"),h._("Jul"),h._("Aug"),h._("Sep"),h._("Oct"),h._("Nov"),h._("Dec")]);return j[a-1]}function u(a){k||(k=[h._("Jan"),h._("Feb"),h._("Mar"),h._("Apr"),h._("May"),h._("Jun"),h._("Jul"),h._("Aug"),h._("Sep"),h._("Oct"),h._("Nov"),h._("Dec")]);return k[a-1]}function v(a){m||(m=["",h._("st"),h._("nd"),h._("rd"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("st"),h._("nd"),h._("rd"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("th"),h._("st")]);return m[a]}function w(a){switch(a){case 1:return h._("1st");case 2:return h._("2nd");case 3:return h._("3rd");case 4:return h._("4th");case 5:return h._("5th");case 6:return h._("6th");case 7:return h._("7th");case 8:return h._("8th");case 9:return h._("9th");case 10:return h._("10th");case 11:return h._("11th");case 12:return h._("12th");case 13:return h._("13th");case 14:return h._("14th");case 15:return h._("15th");case 16:return h._("16th");case 17:return h._("17th");case 18:return h._("18th");case 19:return h._("19th");case 20:return h._("20th");case 21:return h._("21st");case 22:return h._("22nd");case 23:return h._("23rd");case 24:return h._("24th");case 25:return h._("25th");case 26:return h._("26th");case 27:return h._("27th");case 28:return h._("28th");case 29:return h._("29th");case 30:return h._("30th");case 31:return h._("31st");default:throw new Error("Invalid day of month.")}}function x(){return h._("Day:")}function y(){return h._("Month:")}function z(){return h._("Year:")}function A(){return h._("Hour:")}function B(){return h._("Minute:")}function C(){return h._("dd")}function D(){return h._("mm")}function E(){return h._("yyyy")}function F(){return h._("h")}function G(){return h._("m")}function H(a){return a<12?h._("am"):h._("pm")}function I(a){return a<12?h._("AM"):h._("PM")}g.getWeekdayName=a;g.getUppercaseWeekdayName=b;g.getWeekdayNameShort=c;g.getUppercaseWeekdayNameShort=d;g._initializeMonthNames=r;g.getMonthName=e;g.getMonthNames=f;g.getUppercaseMonthName=s;g.getMonthNameShort=t;g.getUppercaseMonthNameShort=u;g.getOrdinalSuffix=v;g.getDayOfMonth=w;g.getDayLabel=x;g.getMonthLabel=y;g.getYearLabel=z;g.getHourLabel=A;g.getMinuteLabel=B;g.getDayPlaceholder=C;g.getMonthPlaceholder=D;g.getYearPlaceholder=E;g.getHourPlaceholder=F;g.getMinutePlaceholder=G;g.get12HourClockSuffix=H;g.getUppercase12HourClockSuffix=I}),98);
__d("padNumber",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a=a.toString();return a.length>=b?a:"0".repeat(b-a.length)+a}f["default"]=a}),66);
__d("intlRenderJSDateSymbol",["DateStrings","padNumber","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f,g){g===void 0&&(g=0);e=e.skipSuffixLocalization===!0;g=g;var h="";switch(b){case"\\":g++;if(f==null)throw c("unrecoverableViolation")("Only deprecated calls to `intlRenderJSDateSymbol()` use `localizedJSFormat`.","internationalization");h=f.charAt(g);break;case"d":h=c("padNumber")(a.dateDay,2);break;case"j":h=a.dateDay;break;case"S":h=d("DateStrings").getOrdinalSuffix(a.dateDay);break;case"D":h=d("DateStrings").getWeekdayNameShort(a.dateDayOfWeek);break;case"l":h=d("DateStrings").getWeekdayName(a.dateDayOfWeek);break;case"F":case"f":h=d("DateStrings").getMonthName(a.dateMonth+1);break;case"M":h=d("DateStrings").getMonthNameShort(a.dateMonth+1);break;case"m":h=c("padNumber")(a.dateMonth+1,2);break;case"n":h=a.dateMonth+1;break;case"Y":h=a.dateYear;break;case"y":h=(""+a.dateYear).slice(2);break;case"a":e?h=a.dateHours<12?"am":"pm":h=d("DateStrings").get12HourClockSuffix(a.dateHours);break;case"A":e?h=a.dateHours<12?"AM":"PM":h=d("DateStrings").getUppercase12HourClockSuffix(a.dateHours);break;case"g":a.dateHours===0||a.dateHours===12?h="12":h=a.dateHours%12;break;case"G":h=a.dateHours;break;case"h":a.dateHours===0||a.dateHours===12?h="12":h=c("padNumber")(a.dateHours%12,2);break;case"H":h=c("padNumber")(a.dateHours,2);break;case"i":h=c("padNumber")(a.dateMinutes,2);break;case"s":h=c("padNumber")(a.dateSeconds,2);break;case"X":h=c("padNumber")(a.dateMilliseconds,3);break;default:h=b}return{idx:g,rendered:String(h)}}g["default"]=a}),98);
__d("intlRenderCLDRDate",["CLDRDateFormatConfig","intlRenderJSDateSymbol","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=/\w+/;function a(a,c,d){var e=b("CLDRDateFormatConfig").intlDateSpecialChars,f="",g="",i=!1,j=[],k;a=a.split(e.cldrDelimiter+e.singleQuote).join(e.singleQuoteHolder);for(var l=0,m=a.length;l<m;l++){var n=a.charAt(l);!i?n===e.cldrDelimiter?i=!0:f.length===0||f[0]===n?f+=n:n===e.singleQuoteHolder?f+=e.singleQuote:(k=h(f,d,c),j.push(k.rendered),f=n):(f.length!==0&&(k=h(f,d,c),j.push(k.rendered),f=""),n===e.cldrDelimiter?(i=!1,j.push(g),g=""):n===e.singleQuoteHolder?g+=e.singleQuote:g+=n)}if(g.length!==0)throw b("unrecoverableViolation")('Format: "'+a+'" must contain closing str literal delimiter',"internationalization");f.length!==0&&(k=h(f,d,c),j.push(k.rendered));return j.join("")}function h(a,c,d){a=i(a);return b("intlRenderJSDateSymbol")(c,a,d)}function i(a){if(a in b("CLDRDateFormatConfig").CLDRToPHPSymbolConversion)return b("CLDRDateFormatConfig").CLDRToPHPSymbolConversion[a];if(g.test(a))throw b("unrecoverableViolation")('Unsupported CLDR symbol: "'+a+'". If string literal, wrap in delimiters',"internationalization");return a}e.exports=a}),null);
__d("formatDate",["CLDRDateFormatConfig","CLDRDateRenderingClientRollout","DateFormatConfig","FBLogger","IntlDateStringsTypedLoggerLite","IsInternSite","Random","getCLDRLocalizedFormat","intlGetDateNumerics","intlRenderCLDRDate","intlRenderJSDateSymbol","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=Object.freeze({today:null,yesterday:null,thisWeek:null,thisMonth:null,thisYear:null,withinDay:null,withinWeek:null,withinMonth:null,withinYear:null,older:null,future:null,allOtherTimes:null});function h(a,b,d){a=a;d=d||{skipSuffixLocalization:!1,skipPatternLocalization:!1,utc:!1,formatInternal:!1,throwCLDRError:!1};if(b==null||b===""||a==null||!(a||a===0))return"";typeof a==="string"&&(isNaN(Number(a))&&c("FBLogger")("i18n-formatDate").event("date_string_must_be_timestamp").blameToPreviousFile().mustfix("The date passed to formatDate is a string, but not a timestamp. formatDate expects strings to be a string representation of a Unix "+('timestamp but was passed "'+a+'"')),a=parseInt(a,10));typeof a==="number"&&(a=new Date(a*1e3));if(!(a instanceof Date))throw c("unrecoverableViolation")("The date passed to formatDate must be either a unix timestamp or JavaScript date object.","internationalization");if(isNaN(a.getTime()))throw c("unrecoverableViolation")("Invalid date passed to formatDate","internationalization");a.getTime()>=1e15&&c("FBLogger")("i18n-formatDate").event("date_too_far_in_future").blameToPreviousFile().info("The date passed to formatDate is too far in the future. Did you mix up milliseconds/seconds?");b=k(a,b);a=c("intlGetDateNumerics")(a,d);return i(b,a,d)}h.DEFAULT_FORMAT="M j, Y g:i A";h.periodNames=Object.freeze(Object.keys(a));function i(a,b,d){var e=a,f=!!d.skipPatternLocalization,g=d.formatInternal===!0;if(!f&&(g||!c("IsInternSite").is_intern_site))if(a in c("CLDRDateFormatConfig").supportedPHPFormatsKeys)try{f=c("CLDRDateFormatConfig").supportedPHPFormatsKeys[a];g=c("getCLDRLocalizedFormat")(f);m(a,f,g);return c("intlRenderCLDRDate")(g,d,b)}catch(a){c("FBLogger")("i18n-formatDate").event("CLDR_date_format_render_error").blameToPreviousFile().catching(a).mustfix("CLDR date format render error");if(d.throwCLDRError===!0)throw a}else if(c("DateFormatConfig").formats[a])e=c("DateFormatConfig").formats[a],m(a);else if(!c("IsInternSite").is_intern_site)if(a.length!==1)throw c("unrecoverableViolation")("Trying to localize an unsupported date format: `"+a+"`","internationalization");return j(e,d,b)}function j(a,b,d){var e=[];for(var f=0;f<a.length;f++){var g=a.charAt(f);g=c("intlRenderJSDateSymbol")(d,g,b,a,f);e.push(g.rendered);f=g.idx}return e.join("")}function k(a,b){var d=h.DEFAULT_FORMAT;if(typeof b==="string")return b;else if(typeof b==="object"){var e=a.getTime();for(var f=l(),g=Array.isArray(f),i=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(g){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;var k=b[j.name];if(k!=null&&j.start<=e&&e<j.end)return k}c("FBLogger")("i18n-formatDate").event("matching_period_format_not_found").blameToPreviousFile().warn('Matching period not found for date "%s", using default format "%s". Current timestamp: "%s"',e,d,Date.now());return d}else{c("FBLogger")("i18n-formatDate").event("invalid_format_argument").blameToPreviousFile().warn('Called with invalid format "%s" (type: %s) for date "%s", using default: %s',b,typeof b,a.getTime(),d);return d}}function l(){var a=new Date(),b=a.getTime(),d=a.getFullYear(),e=a.getMonth(),f=new Date(d,a.getMonth()+1,0).getDate(),g=new Date(d,1,29).getMonth()===1?366:365,h=1e3*60*60*24,i=new Date(a.setHours(0,0,0,0)),j=new Date(d,e,i.getDate()+1);a=a.getDate()-(a.getDay()-c("DateFormatConfig").weekStart+6)%7;var k=new Date(b).setDate(a);a=new Date(b).setDate(a+7);var l=new Date(d,e,1);e=new Date(d,e,f+1);var m=new Date(d,0,1);d=new Date(d+1,0,1);return[{name:"today",start:i.getTime(),end:j.getTime()},{name:"withinDay",start:b-h,end:b+h},{name:"yesterday",start:i.getTime()-h,end:i.getTime()-1},{name:"thisWeek",start:k,end:a},{name:"withinWeek",start:b-h*7,end:b+h*7},{name:"thisMonth",start:l.getTime(),end:e.getTime()},{name:"withinMonth",start:b-h*f,end:b+h*f},{name:"thisYear",start:m.getTime(),end:d.getTime()},{name:"withinYear",start:b-h*g,end:b+h*g},{name:"older",start:-Infinity,end:b},{name:"future",start:b,end:+Infinity},{name:"allOtherTimes",start:-Infinity,end:+Infinity}]}function m(a,b,d){b===void 0&&(b=null),d===void 0&&(d=null),c("Random").random()<c("CLDRDateRenderingClientRollout").formatDateClientLoggerSamplingRate&&c("IntlDateStringsTypedLoggerLite").log({datetime_format:a,logged_from_client:!0,cldr_key:b,cldr_value:d})}b=h;g["default"]=b}),98);
__d("MMessagePayload",["fbt","ChannelEventType","CurrentUser","MercuryAttachmentSnippetRenderer","MercuryAudioType","P2PPaymentRequestStatus","P2PTransferStatus","formatDate"],(function(a,b,c,d,e,f,g,h){"use strict";var i=25,j=1e3,k="g:ia";a=function(){function a(a){this.$1=a}var b=a.prototype;b.isPageMessage=function(){return this.$1.type===d("ChannelEventType").PAGES_MESSAGE};b.getThreadFBID=function(){return this.$1.thread_fbid?this.$1.thread_fbid.toString():null};b.getHref=function(){return this.$1.href};b.getAuthorFBID=function(){return this.$1.sender_fbid.toString()};b.getAuthorName=function(){return this.$1.sender_name};b.getThreadName=function(){return this.$1.thread_name};b.getThreadUnreadCount=function(){return this.$1.thread_unread_count};b.getSnippet=function(){var a=this.$1.log_message?this.$1.log_message:this.$1.body;if(a)if(a.length>i)return h._("{shortened body}{dot dot dot (for truncation)}",[h._param("shortened body",a.substring(0,i)),h._param("dot dot dot (for truncation)","...")]);else return a;a=this.$1.attachments.map(function(a){if(a.sticker_attachment)return{attach_type:"sticker",metadata:{stickerID:a.sticker_attachment.id}};else if(a.blob_attachment)if(a.blob_attachment.__typename==="MessageImage")if(a.blob_attachment.render_as_sticker)return{attach_type:"third_party_sticker"};else return{attach_type:"photo"};else if(a.blob_attachment.__typename==="MessageAnimatedImage")return{attach_type:"animated_image"};else if(a.blob_attachment.__typename==="MessageVideo")return{attach_type:"video"};else if(a.blob_attachment.audio_type&&(a.blob_attachment.audio_type==="VOICE_MESSAGE"||a.blob_attachment.audio_type==="VOICE_MESSAGE_WITH_TRANSCRIPT"))return{metadata:{type:c("MercuryAudioType").AudioClip}};else if(a.blob_attachment.__typename==="MessageFile")if(a.blob_attachment.is_malicious)return{attach_type:"error"};else return{attach_type:"file"};else return{attach_type:"unknown"};else if(a.extensible_attachment)if(a.extensible_attachment.story_attachment){var b;a=a.extensible_attachment.story_attachment;var d=a.target;b=(b=d)!=null?b.__typename:b;if(b==="MessengerBusinessMessage"){return{share:{style_list:a.style_list,target:{message:(a=d)!=null?a.message:a}},attach_type:"share"}}else if(b==="PeerToPeerPaymentRequest"){var e;a=(a=d)!=null?a.request_status:a;return{share:{style_list:["orion_request"],target:{requester:{id:(e=d)!=null?(e=e.requester)!=null?e.id:e:e,name:(e=d)!=null?(e=e.requester)!=null?e.short_name:e:e},amountWithSymbol:(e=d)!=null?(e=e.amount)!=null?e.formatted:e:e,currentStatus:a?c("P2PPaymentRequestStatus")[a]:null,requestee:{id:(e=d)!=null?(e=e.requestee)!=null?e.id:e:e,name:(a=d)!=null?(a=a.requestee)!=null?a.short_name:a:a}}},attach_type:"share"}}else if(b==="PeerToPeerTransfer"){a=(e=d)!=null?e.transfer_status:e;return{share:{style_list:["orion"],target:{sender:(e=d)!=null?e.sender:e,amountWithSymbol:(e=d)!=null?(e=e.transaction_amount)!=null?e.formatted_amount:e:e,status:a?c("P2PTransferStatus")[a]:null,receiver:{id:(e=d)!=null?(e=e.receiver_profile)!=null?e.id:e:e,name:(a=d)!=null?(a=a.receiver_profile)!=null?a.short_name:a:a}}},attach_type:"share"}}else if(b==="MessageLiveLocation")return{share:{style_list:["message_live_location"]},attach_type:"share"};else if(b==="MessageLocation")return{share:{style_list:["message_location"]},attach_type:"share"};return{attach_type:"share"}}else return{attach_type:"share"};else return{attach_type:"unknown"}});var b=d("MercuryAttachmentSnippetRenderer").getAttachmentSnippetType(a);return d("MercuryAttachmentSnippetRenderer").renderAttachmentSnippetText(b,this.getAuthorFBID()===c("CurrentUser").getID(),this.getAuthorName(),a)};b.getMessage=function(){return this.$1.body};b.getTime=function(){return c("formatDate")(this.$1.timestamp/j,k)};b.getTimestamp=function(){return this.$1.timestamp.toString()};b.getUUID=function(){return this.$1.message_id};b.getFolder=function(){return this.$1.folder};b.getMessageSource=function(){return this.$1.source};b.getParticipantIDs=function(){var a=this.$1.participant_ids||[];return a.map(function(a){return a.toString()})};b.hasThreadImage=function(){return this.$1.has_thread_image};b.hasWorkForeignParticipants=function(){return this.$1.work_foreign_participant_ids&&this.$1.work_foreign_participant_ids.length>0};b.getWorkForeignParticipantIds=function(){return this.$1.work_foreign_participant_ids};b.getAttachmentCount=function(){return this.$1.attachments.length};b.getAttachments=function(){return this.$1.attachments};b.isCanonicalThread=function(){return!!this.$1.is_canonical};b.isUnread=function(){return this.$1.is_unread};b.getOtherUserFBID=function(){var a=this.$1.participant_ids;if(!this.isCanonicalThread())return null;else if(a.length===1)return a[0].toString();else return a[0].toString()===c("CurrentUser").getID()?this.isPageMessage()?a[0].toString():a[1].toString():a[0].toString()};b.getThreadNameWithUnreadCount=function(){return!this.getThreadUnreadCount()?this.getThreadName():h._("{thread name} ({unread count})",[h._param("thread name",this.getThreadName()),h._param("unread count",this.getThreadUnreadCount())])};return a}();g["default"]=a}),98);
__d("CallbackManagerController",["ErrorGuard"],(function(a,b,c,d,e,f){var g;a=function(){function a(a){this.$2=[],this.$1=[void 0],this.$3=a}var c=a.prototype;c.executeOrEnqueue=function(a,b,c){c=Boolean(c)?c:{};var d=this.$4(b,a,c);if(d)return 0;this.$1.push({fn:b,request:a,options:c});d=this.$1.length-1;this.$2.push(d);return d};c.unsubscribe=function(a){delete this.$1[a]};c.reset=function(){this.$1=[]};c.getRequest=function(a){return this.$1[a]};c.runPossibleCallbacks=function(a){var b=this,c=this.$2;this.$2=[];var d=[];c.forEach(function(c){var e=b.$1[c];if(!e)return;e=b.$3(e.request,babelHelpers["extends"]({},e.options,a));e?d.push({args:e,id:c}):b.$2.push(c)});d.forEach(function(a){var c=a.args;a=a.id;var d=b.$1[a];if(!d)return;delete b.$1[a];b.$5(d.fn,c,d.request)})};c.$4=function(a,b,c){c=this.$3(b,c);c&&this.$5(a,c,b);return!!c};c.$5=function(a,c,d){d={ids:d};(g||(g=b("ErrorGuard"))).applyWithGuard(a,d,c)};return a}();f["default"]=a}),66);
__d("KeyedCallbackManager",["CallbackManagerController","FBLogger"],(function(a,b,c,d,e,f){a=function(){function a(){this.$2={},this.$1=new(b("CallbackManagerController"))(this.$3.bind(this))}var c=a.prototype;c.executeOrEnqueue=function(a,c){if(!(a instanceof Array)){var d=a,e=c;a=[a];c=function(a){e(a[d])}}a=a.filter(function(a){var c=a!==null&&a!==void 0;c||b("FBLogger")("KeyedCallbackManager").mustfix("KeyedCallbackManager.executeOrEnqueue: key %s is invalid",JSON.stringify(a));return c});return this.$1.executeOrEnqueue(a,c)};c.unsubscribe=function(a){this.$1.unsubscribe(a)};c.reset=function(){this.$1.reset(),this.$2={}};c.getUnavailableResources=function(a){var b=this;a=this.$1.getRequest(a);var c=[];a&&(c=a.request.filter(function(a){return!b.$2[a]}));return c};c.getUnavailableResourcesFromRequest=function(a){var b=this;a=Array.isArray(a)?a:[a];return a.filter(function(a){if(a!==null&&a!==void 0)return!b.$2[a]})};c.addResourcesAndExecute=function(a){Object.assign(this.$2,a),this.$1.runPossibleCallbacks()};c.setResource=function(a,b){this.$2[a]=b,this.$1.runPossibleCallbacks()};c.getResource=function(a){return this.$2[a]};c.getAllResources=function(){return this.$2};c.dumpResources=function(){var a=this,b={};Object.keys(this.$2).forEach(function(c){var d=a.$2[c];typeof d==="object"&&(d=babelHelpers["extends"]({},d));b[c]=d});return b};c.$3=function(a){var b={};for(var c=0;c<a.length;c++){var d=a[c],e=this.$2[d];if(typeof e==="undefined")return!1;b[d]=e}return[b]};return a}();f["default"]=a}),66);
__d("MMessageServerResourceFetcher",["KeyedCallbackManager","MRequest"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$3=a,this.$4=b,this.$1=new(c("KeyedCallbackManager"))(),this.$2={}}var b=a.prototype;b.get=function(a,b){this.getMulti([a],function(c){b(c[a])})};b.getMulti=function(a,b){var d=this;b=!this.$1.executeOrEnqueue(a,b);if(b)return;var e=a.filter(function(a){var b=!d.$1.getResource(a)&&!d.$2[a];b&&(d.$2[a]=!0);return b});if(e.length===0)return;b=new(c("MRequest"))(this.$3(e)).setMethod("POST");b.listen("done",function(a){if(!a||!a.payload)return;a=d.$4(a.payload);a&&d.$1.addResourcesAndExecute(a)});b.listen("finally",function(a){e.forEach(function(){delete d.$2[a]})});b.send()};b.set=function(a,b){var c={};c[a]=b;this.$1.addResourcesAndExecute(c)};return a}();g["default"]=a}),98);
__d("MercurySingletonProvider",["CurrentUser"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1={},this.$2=a}var c=a.prototype;c.getForFBID=function(a){this.$1[a]||(this.$1[a]=new this.$2(a));return this.$1[a]};c.get=function(){return this.getForFBID(b("CurrentUser").getID())};c.resetAll=function(){var a=this.$1;this.$1={};return a};a.mock=function(a){throw new Error("MercurySingletonProvider.mock() must only be used in tests.")};return a}();e.exports=a}),null);
__d("XChatThreadInfoAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/chat/thread_info/",{thread_fbids:{type:"StringVector",defaultValue:[]},other_user_fbids:{type:"StringVector",defaultValue:[]}})}),null);
__d("MMessagesThreadDataStore",["ActorURI","CurrentUser","MMessageServerResourceFetcher","MercurySingletonProvider","XChatThreadInfoAsyncController"],(function(a,b,c,d,e,f,g){"use strict";var h=null;a=function(){a.getProvider=function(){h===null&&(h=new(c("MercurySingletonProvider"))(a));return h};a.getForFBID=function(b){return a.getProvider().getForFBID(b)};a.get=function(){return a.getProvider().get()};function a(a){this.$6=a,this.$1=new(c("MMessageServerResourceFetcher"))(function(b){b=c("XChatThreadInfoAsyncController").getURIBuilder().setStringVector("other_user_fbids",b).getURI();c("CurrentUser").getID()!==a&&(b=d("ActorURI").create(b,a));return b.toString()},function(a){return a.profiles}),this.$2=new(c("MMessageServerResourceFetcher"))(function(b){b=c("XChatThreadInfoAsyncController").getURIBuilder().setStringVector("thread_fbids",b).getURI();c("CurrentUser").getID()!==a&&(b=d("ActorURI").create(b,a));return b.toString()},function(a){return a.profiles}),this.$3={},this.$5={},this.$4={}}var b=a.prototype;b.$7=function(a,b){if(a)return this.$1;else return this.$2};b.getForNewMessage=function(a,b,c,d,e){var f=this,g=this.$7(a,b),h=a||b;g.get(h,function(a){f.$3[h]===void 0?(f.$3[h]=a.unread_count,delete a.unread_count,f.$5[c]=!0):f.$5[c]||(delete a.unread_count,f.$5[c]=!0,d?f.$3[h]=f.$3[h]+1:f.$3[h]=0),f.$4[h]===void 0&&(f.$4[h]=a.pages_is_flagged),a.thread_unread_count=f.$3[h],e(a)})};b.updateFlagStatus=function(a,b,c,d){var e=this;if(typeof c!=="boolean")return;var f=this.$7(a,b),g=a||b;f.get(g,function(a){e.$4[g]=c,d()})};b.getIsThreadFlagged=function(a,b){a=a||b;return this.$4[a]};b.clearUnreadCount=function(a,b,c){var d=this,e=this.$7(a,b),f=a||b;e.get(f,function(a){d.$3[f]=0,c()})};b.clearAllUnread=function(){this.$3={}};return a}();g["default"]=a}),98);
__d("XChatUserInfoAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/chat/user_info/",{ids:{type:"IntVector",defaultValue:[]}})}),null);
__d("MShortProfiles",["FBLogger","MMessageServerResourceFetcher","XChatUserInfoAsyncController","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("MMessageServerResourceFetcher"))(function(a){if(c("gkx")("2421")){var b=new Error("chat user info is being used");b.stack;c("FBLogger")("messenger_comet").catching(b).warn("chat user info is being used here")}return c("XChatUserInfoAsyncController").getURIBuilder().setIntVector("ids",a.map(Number)).getURI().toString()},function(a){return a.profiles});function a(a,b){h.get(a,b)}function b(a,b){h.getMulti(a,b)}function d(a,b){h.set(a,b)}g.get=a;g.getMulti=b;g.set=d}),98);
__d("MercuryIDs",["gkx"],(function(a,b,c,d,e,f){"use strict";var g={isValid:function(a){return a==null||a===""||typeof a!=="string"?!1:/^\w{3,12}:.+/.test(a)},isValidThreadID:function(a){if(!g.isValid(a))return!1;a=g.tokenize(a);switch(a.type){case"user":case"support":case"thread":case"root":return!0;default:return(a.type==="pending"||a.type==="group")&&!b("gkx")("863760")?!0:!1}},tokenize:function(a){if(a==null||a===""||!g.isValid(a))throw new Error("bad_id_format "+String(a));var b=a.indexOf(":");return{type:a.substr(0,b),value:a.substr(b+1)}},getUserIDFromParticipantID:function(a){if(!g.isValid(a))throw new Error("bad_id_format "+a);a=g.tokenize(a);var b=a.type;a=a.value;return b==="fbid"?a:null},getParticipantIDFromUserID:function(a){if(isNaN(a))throw new Error("Not a user ID: "+a);return"fbid:"+a},getUserIDFromThreadID:function(a){return!this.isCanonical(a)?null:this.tokenize(a).value},getThreadIDFromUserID:function(a){return"user:"+a},getThreadIDFromThreadFBID:function(a){return"thread:"+a},getThreadIDFromSupportInboxItemID:function(a){return"support:"+a},getThreadFBIDFromThreadID:function(a){return this.tokenize(a).value},getThreadKeyfromThreadIDUserID:function(a,b){if(a==null||a===""||!g.isValid(a))throw new Error("bad_id_format "+String(a));var c=this.tokenize(a).type;a=this.tokenize(a).value;if(c!=="user")return"g"+a;c="";var d="";if(a.length!==b.length)a.length>b.length?(c=a,d=b):(c=b,d=a);else if(b===a)return b+"u"+a;else{var e=0;while(e<a.length&&e<b.length)if(a[e]===b[e])e++;else{a[e]>b[e]?(c=a,d=b):(c=b,d=a);break}}return d+"u"+c},getThreadIDFromParticipantID:function(a){a=this.getUserIDFromParticipantID(a);return a?this.getThreadIDFromUserID(a):null},getParticipantIDFromFromThreadID:function(a){a=this.getUserIDFromThreadID(a);return a?this.getParticipantIDFromUserID(a):null},getSupportInboxItemIDFromThreadID:function(a){return this.tokenize(a).value},isCanonical:function(a){return this.isValid(a)&&this.tokenize(a).type==="user"},isGroupChat:function(a){return this.isValid(a)&&this.tokenize(a).type!=="user"},isLocalThread:function(a){return this.isValid(a)&&this.tokenize(a).type==="root"}};e.exports=g}),null);
__d("MMessagesChannelPayloadPreparer",["MMessagePayload","MMessagesConfig","MMessagesThreadDataStore","MShortProfiles","MercuryIDs","Promise","Stratcom","promiseDone"],(function(a,b,c,d,e,f){"use strict";var g={fetchDataThenDispatch:function(a){a.message.folder=a.folder;a.message.sender_fbid=b("MercuryIDs").getUserIDFromParticipantID(a.message.author);b("MMessagesConfig").msite_genie_xma_rendering&&g._processGenieMessage(a.message);var c=a.targetFBID?a.targetFBID:a.realtime_viewer_fbid.toString(),d=[new(b("Promise"))(function(d,e){e=b("MMessagesThreadDataStore").getForFBID(c);e.getForNewMessage(a.message.other_user_fbid,a.message.thread_fbid,a.message.message_id,a.message.is_unread,function(a){d(a)})}),new(b("Promise"))(function(c,d){b("MShortProfiles").get(a.message.sender_fbid.toString(),function(a){c(a)})})];b("promiseDone")(b("Promise").all(d),function(c){var d=c[0];c=c[1];Object.assign(a.message,{is_muted:d.mute_until!==void 0,thread_name:d.thread_name,participant_ids:d.participant_ids,has_thread_image:d.has_thread_image,work_foreign_participant_ids:d.work_foreign_participant_ids,is_canonical:d.is_canonical,href:d.href,thread_unread_count:d.thread_unread_count,pages_is_flagged:d.pages_is_flagged,sender_name:c.name,type:a.type});a.parsedPayload=new(b("MMessagePayload"))(a.message);b("Stratcom").invoke(a.type,null,a)})},_processGenieMessage:function(a){if(!a.has_attachment||!a.attachments)return;for(var b=a.attachments.length-1;b>=0;b-=1){var c=a.attachments[b];if(!c.share||!c.share.style_list||c.share.style_list[0]!="genie_message")continue;c.share.target.genie_id&&(a.sender_fbid=c.share.target.genie_id,a.sender="fbid:"+c.share.target.genie_id);c.share.target.genie_name&&(a.sender_name=c.share.target.genie_name);c.share.target&&!c.share.target.attachment&&(a.attachments.splice(b,1),a.has_attachment=a.attachments.length>0)}}};e.exports=g}),null);
__d("XVideoHomeMobileBadgingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/watch/m/badge/",{})}),null);
__d("MWatchJewel",["CSS","DOM","MRequest","Stratcom","XVideoHomeMobileBadgingController","formatNumber"],(function(a,b,c,d,e,f,g){var h,i,j=9,k="videos_tab_jewel_button";function a(a,b){h=a;var d=c("Stratcom").listen("click",k,function(){l(0),d.remove()});if(b){i=c("DOM").find(h,"span","count");a=c("XVideoHomeMobileBadgingController").getURIBuilder().getURI();b=new(c("MRequest"))(a);b.listen("done",function(a){l(a.payload.count)});b.send()}}function l(a){var b=c("formatNumber").withMaxLimit(a,j).toString();c("DOM").setContent(i,b);c("CSS").conditionClass(h,"noCount",a===0);c("CSS").conditionClass(h,"hasCount",a>0);c("CSS").conditionClass(h,"largeCount",b.length>1)}b={init:a};g["default"]=b}),98);
__d("MMessagesReadReceipts",[],(function(a,b,c,d,e,f){"use strict";var g=void 0,h={};function a(a,b){g=a,h=b}function b(a,b){if(a!==g)return;for(var a in b){if(!Object.prototype.hasOwnProperty.call(b,a))continue;var c=b[a].action,d=h[a].action;d===void 0?h[a]=b[a]:h[a]=Math.max(d,c)===d?h[a]:b[a]}}function c(a,b,c){if(a!==g)return{};a={};for(var d in h){if(!Object.prototype.hasOwnProperty.call(h,d))continue;else if(c.indexOf(d)!==-1)continue;else if(h[d].action<b)continue;a[d]=h[d].action}return a}f.init=a;f.update=b;f.getSeenBy=c}),66);
__d("IrisProtocolMessageLifetime",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({TTL_OFF:0,TTL_ON_UNKNOWN:1,TTL_30SECONDS:3e4,TTL_1MINUTE:6e4,TTL_3MINUTES:18e4,TTL_5MINUTES:3e5,TTL_10MINUTES:6e5,TTL_15MINUTES:9e5,TTL_30MINUTES:18e5,TTL_1HOUR:36e5,TTL_2HOURS:72e5,TTL_4HOURS:144e5,TTL_8HOURS:288e5,TTL_12HOURS:432e5,TTL_24HOURS:864e5,TTL_36HOURS:1296e5,TTL_72HOURS:2592e5})}),null);
__d("MercuryMessageCustomizations",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=JSON.parse(a),c=[];Object.keys(b).forEach(function(a){c.push({customization_type:a,customization_value:b[a]})});return c}f.parseCustomizations=a}),66);
__d("MercuryProfileRanges",[],(function(a,b,c,d,e,f){"use strict";function g(a){return!a.id&&a.i?{id:a.i,offset:a.o,length:a.l,type:a.t}:a}e.exports={extractFromDelta:function(a){a=(a=a)!=null?(a=a.data)!=null?a.prng:a:a;if(!a)return[];var b=[];try{b=JSON.parse(a);if(b.length>0)return b.map(g)}catch(a){}return b}}}),null);
__d("MessageThreadReadState",[],(function(a,b,c,d,e,f){"use strict";a={MARK_READ:1,MARK_UNREAD:2,KEEP_AS_IS:3};b=a;f["default"]=b}),66);
__d("MessageThreadReadStateEffect",["MessageThreadReadState"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d=b.messageMetadata.threadReadStateEffect;if(d!=null){var e=c("MessageThreadReadState")[d];return e===void 0&&typeof d==="number"?d:e}d=b.messageMetadata.skipBumpThread;return d===!0?c("MessageThreadReadState").KEEP_AS_IS:a!==b.messageMetadata.actorFbId?c("MessageThreadReadState").MARK_UNREAD:c("MessageThreadReadState").KEEP_AS_IS}g.extractThreadStateEffectFromDelta=a}),98);
__d("MMercurySyncNewMessageTransformer",["IrisProtocolMessageLifetime","MercuryIDs","MercuryMessageCustomizations","MercuryProfileRanges","MessageThreadReadState","MessageThreadReadStateEffect","MessagingTag"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){var b={};try{b=JSON.parse(a)}catch(a){}return b instanceof Array?b[0]:b};function a(a,b){var e=parseInt(b.messageMetadata.timestamp,10),f=b.messageMetadata.skipBumpThread,g=d("MessageThreadReadStateEffect").extractThreadStateEffectFromDelta(a,b);a=g===c("MessageThreadReadState").MARK_UNREAD&&a!==b.messageMetadata.actorFbId;var i=[];b.attachments&&(i=b.attachments.map(function(a){return a.mercury}));var j=b.messageMetadata.tags?b.messageMetadata.tags[0]:void 0;return{message_id:b.messageMetadata.messageId,threading_id:null,offline_threading_id:b.messageMetadata.offlineThreadingId,author:d("MercuryIDs").getParticipantIDFromUserID(b.messageMetadata.actorFbId),author_email:b.messageMetadata.actorFbId+"@facebook.com",ephemeral_ttl_mode:b.ttl?c("IrisProtocolMessageLifetime")[b.ttl]:0,timestamp:e,is_unread:a,is_filtered_content:!1,is_filtered_content_bh:!1,is_filtered_content_account:!1,is_filtered_content_quasar:!1,is_filtered_content_invalid_app:!1,source:j,tags:b.messageMetadata.tags,is_spoof_warning:!1,folder:c("MessagingTag").INBOX,thread_fbid:b.messageMetadata.threadKey.threadFbId,other_user_fbid:b.messageMetadata.threadKey.otherUserFbId,body:b.body!==void 0?b.body:"",html_body:null,subject:null,has_attachment:i.length>0,attachments:i,ranges:void 0,thread_id:null,action_type:"ma-type:user-generated-message",is_from_iris:!0,is_sponsored:!!(b.data&&b.data.is_sponsored&&b.data.is_sponsored==="true")||!!(b.untypedData&&b.untypedData.is_sponsored&&b.untypedData.is_sponsored==="true"),commerce_message_type:b.data?b.data.commerce_message_type:null,customizations:b.data&&b.data.customization?d("MercuryMessageCustomizations").parseCustomizations(b.data.customization):null,platform_xmd:b.data&&b.data.platform_xmd?b.data.platform_xmd:null,profile_ranges:d("MercuryProfileRanges").extractFromDelta(b),message_source:b.data&&b.data.message_source_data?h(b.data.message_source_data).message_source:null,skip_bump_thread:f,thread_read_state_effect:g,montage_reply_data:b.data&&b.data.montage_reply_data?h(b.data.montage_reply_data):null,meta_ranges:b.data&&b.data.meta_ranges?h(b.data.meta_ranges):null}}g.transform=a}),98);
__d("MMercurySyncReplaceMessageTransformer",["MMercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=babelHelpers["extends"]({},b.newMessage,b);return Object.assign(d("MMercurySyncNewMessageTransformer").transform(a,b),{action_type:"ma-type:replace-message",replaced_message_id:b.replacedMessageId})}g.transform=a}),98);
__d("MMercuryUnsendMessageProcessor",[],(function(a,b,c,d,e,f){"use strict";function a(){document.location.reload()}f.process=a}),66);
__d("MReplaceMessageProcessor",[],(function(a,b,c,d,e,f){"use strict";function a(a){}f.process=a}),66);
__d("MercurySyncDeltaTypes",[],(function(a,b,c,d,e,f){"use strict";a={AdminAddedToGroupThread:"AdminAddedToGroupThread",AdminRemovedFromGroupThread:"AdminRemovedFromGroupThread",AdminTextMessage:"AdminTextMessage",ChangeViewerStatus:"ChangeViewerStatus",DeliveryReceipt:"DeliveryReceipt",ForcedFetch:"ForcedFetch",MarkRead:"MarkRead",MarkUnread:"MarkUnread",MarkFolderSeen:"MarkFolderSeen",MessageDelete:"MessageDelete",NewMessage:"NewMessage",NoOp:"NoOp",PagesManagerEvent:"PagesManagerEvent",ParticipantLeftGroupThread:"ParticipantLeftGroupThread",ParticipantsAddedToGroupThread:"ParticipantsAddedToGroupThread",ReadReceipt:"ReadReceipt",ReplaceMessage:"ReplaceMessage",ThreadAction:"ThreadAction",ThreadDelete:"ThreadDelete",ThreadFolder:"ThreadFolder",ThreadMuteSettings:"ThreadMuteSettings",ThreadName:"ThreadName",JoinableMode:"JoinableMode",ApprovalMode:"ApprovalMode",ApprovalQueue:"ApprovalQueue",ClientPayload:"ClientPayload",GenieMessage:"GenieMessage",MontageMessage:"MontageMessage",RtcCallData:"RtcCallData"};b=a;f["default"]=b}),66);
__d("MercurySyncMarkFolderSeenTransformer",["MessagingTag"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.folders.map(function(b){return{action_type:"mga-type:mark-all-seen",folder:c("MessagingTag").IRIS_MAPPING[b],timestamp:parseInt(a.timestamp,10)}})}g.transform=a}),98);
__d("MercurySyncMarkReadTransformer",["MessagingTag"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.folders&&a.folders.length>0?a.folders.map(function(b){return{action_type:"mga-type:mark-all-read",action_id:null,folder:c("MessagingTag").IRIS_MAPPING[b],timestamp:parseInt(a.watermarkTimestamp,10)}}):a.threadKeys.map(function(b){return{action_type:"ma-type:change_read_status",other_user_fbid:b.otherUserFbId,thread_fbid:b.threadFbId,mark_as_read:!0,timestamp:parseInt(a.watermarkTimestamp,10),folder:c("MessagingTag").INBOX}})}g.transform=a}),98);
__d("MercurySyncMarkUnreadTransformer",["MessagingTag"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.threadKeys.map(function(b){return{action_type:"ma-type:change_read_status",other_user_fbid:b.otherUserFbId,thread_fbid:b.threadFbId,mark_as_read:!1,timestamp:parseInt(a.watermarkTimestamp,10),folder:c("MessagingTag").INBOX}})}g.transform=a}),98);
__d("MercurySyncPagesManagerEventTransformer",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=JSON.parse(a.jsonBlob),c=b&&b.type;if(!c)return void 0;switch(c){case 1:c=!!(b&&b.flagData&&b.flagData.state);b={action_type:"ma-type:change_flag",mark_as_flag:c,other_user_fbid:a.threadKey.otherUserFbId,thread_fbid:a.threadKey.threadFbId};return b;default:return void 0}}f.transform=a}),66);
__d("MercurySyncReadReceiptTransformer",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b={watermark:parseInt(a.watermarkTimestampMs,10),action:parseInt(a.actionTimestampMs,10)},c=a.threadKey.otherUserFbId||a.actorFbId;a=a.threadKey.otherUserFbId||a.threadKey.threadFbId;var d={roger:{}};d.roger[a]={};d.roger[a][c]=b;return d}f.transform=a}),66);
__d("MMercurySyncDispatcher",["ChannelEventType","CurrentUser","MMercurySyncNewMessageTransformer","MMercurySyncReplaceMessageTransformer","MMercuryUnsendMessageProcessor","MMessagesChannelPayloadPreparer","MMessagesReadReceipts","MMessagesThreadDataStore","MReplaceMessageProcessor","MercurySingletonProvider","MercurySyncDeltaTypes","MercurySyncMarkFolderSeenTransformer","MercurySyncMarkReadTransformer","MercurySyncMarkUnreadTransformer","MercurySyncPagesManagerEventTransformer","MercurySyncReadReceiptTransformer","MessagingTag","ODS","Stratcom","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i={};a=function(){a.getProvider=function(){h===null&&(h=new(c("MercurySingletonProvider"))(a));return h};a.getForFBID=function(b){return a.getProvider().getForFBID(b)};a.get=function(){return a.getProvider().get()};function a(a){this.$1=a,this.$2=c("CurrentUser").getAccountID()===this.$1?d("ChannelEventType").MESSAGE:d("ChannelEventType").PAGES_MESSAGE}var b=a.prototype;b.process=function(a,b){var e=this,f="none";a!=null&&a["class"]!=null&&a["class"]!=""&&(f=a["class"]);d("ODS").bumpEntityKey(2966,"SyncDispatcher","receive."+b+"."+f);if(b==="cp")return;if(a.irisTags&&a.irisTags.includes("interop_may_suppress"))return;switch(a["class"]){case c("MercurySyncDeltaTypes").NewMessage:f=a.messageMetadata.offlineThreadingId+"|"+(a.messageMetadata.actorFbId||"");b=f!=null?i[f]!==void 0:!1;if(b)break;f!=null&&(i[f]=!0);if(a.messageMetadata.folderId&&a.messageMetadata.folderId.userCreatedId!==null&&a.messageMetadata.folderId.userCreatedId!==void 0)break;b=d("MMercurySyncNewMessageTransformer").transform(this.$1,a);f={message:b,type:this.$2,folder:c("MessagingTag").INBOX,targetFBID:this.$1};d("MMessagesChannelPayloadPreparer").fetchDataThenDispatch(f);break;case c("MercurySyncDeltaTypes").MarkUnread:b=d("MercurySyncMarkUnreadTransformer").transform(a);b.map(function(a){f={message:a,type:e.$2,event:"unread",is_sync:!0,targetFBID:e.$1},c("Stratcom").invoke(f.type,null,f)});break;case c("MercurySyncDeltaTypes").MarkRead:b=d("MercurySyncMarkReadTransformer").transform(a);b.map(function(a){a.action_type==="mga-type:mark-all-read"?c("MMessagesThreadDataStore").getForFBID(e.$1).clearAllUnread():c("MMessagesThreadDataStore").getForFBID(e.$1).clearUnreadCount(a.other_user_fbid,a.thread_fbid,c("emptyFunction")),f={message:a,type:e.$2,event:a.action_type==="mga-type:mark-all-read"?"mark_all_read":"read",is_sync:!0,targetFBID:e.$1},c("Stratcom").invoke(f.type,null,f)});break;case c("MercurySyncDeltaTypes").MarkFolderSeen:b=d("MercurySyncMarkFolderSeenTransformer").transform(a);b.map(function(a){f={message:a,type:e.$2,event:"mark_all_seen",is_sync:!0,targetFBID:e.$1},c("Stratcom").invoke(f.type,null,f)});break;case c("MercurySyncDeltaTypes").ReadReceipt:b=d("MercurySyncReadReceiptTransformer").transform(a);var g=Object.keys(b.roger)[0],h=b.roger[g];d("MMessagesReadReceipts").update(g,h);f={message:b,type:this.$2,event:"read_receipt",is_sync:!0,targetFBID:this.$1};c("Stratcom").invoke(f.type,null,f);break;case c("MercurySyncDeltaTypes").PagesManagerEvent:b=d("MercurySyncPagesManagerEventTransformer").transform(a);if(!b||b.action_type!=="ma-type:change_flag")return;c("MMessagesThreadDataStore").getForFBID(this.$1).updateFlagStatus(b.other_user_fbid,null,b.mark_as_flag,c("emptyFunction"));f={event:d("ChannelEventType").PAGE_THREAD_FLAG_CHANGED,flagged:b.mark_as_flag,other_user_fbid:b.other_user_fbid,type:d("ChannelEventType").PAGES_MESSAGE};c("Stratcom").invoke(f.type,null,f);break;case c("MercurySyncDeltaTypes").ReplaceMessage:b=d("MMercurySyncReplaceMessageTransformer").transform(this.$1,a);f={message:b,type:this.$2,folder:c("MessagingTag").INBOX,targetFBID:this.$1};d("MReplaceMessageProcessor").process(f);c("Stratcom").invoke(f.type,null,f);break;case c("MercurySyncDeltaTypes").ClientPayload:g=JSON.parse(String.fromCharCode.apply(null,a.payload));h=g&&g.deltas;if(h.length>0){a=h[0];if(a.deltaMessageReply){g=a.deltaMessageReply.message;b=d("MMercurySyncNewMessageTransformer").transform(this.$1,g);f={message:b,type:this.$2,folder:c("MessagingTag").INBOX,targetFBID:this.$1};d("MMessagesChannelPayloadPreparer").fetchDataThenDispatch(f)}a.deltaRecallMessageData&&d("MMercuryUnsendMessageProcessor").process()}break;default:break}};return a}();g["default"]=a}),98);
__d("SyncProtocolConstants",[],(function(a,b,c,d,e,f){a="IRIS_CURSOR_LIMIT";b="SNAPSHOT_FAILURE";f.IRIS_CURSOR_LIMIT=a;f.SNAPSHOT_FAILURE=b}),66);
__d("SyncProtocolClient",["Int64","MercurySingletonProvider","MqttEnv","SyncProtocolConstants","exponentialBackoff"],(function(a,b,c,d,e,f,g){"use strict";a=function(){a.getForFBID=function(a){return h.getForFBID(a)};function a(a){var b=this;this.$1=a;this.$2=[];this.$5=d("MqttEnv").Env.getLoggerInstance();this.$10=new(c("exponentialBackoff"))(function(){return b.$12()},this)}var b=a.prototype;b.getPublishMessages=function(){return this.$13()};b.init=function(a,b,d,e,f){var g=this;if(!b&&!e){this.$5.bumpCounter("sp_init_invalid_parameter");return this}this.$9=a;this.$8=!0;this.$3=b?c("Int64").fromString(b):null;this.$6=d;this.$7=e;this.$4=null;this.$11=f;this.$9.subscribe("/t_ms",function(a){return g.$14(a)});this.$9.subscribe("/thread_typing",function(a){g.$15(a)});this.$9.subscribe("/orca_typing_notifications",function(a){g.$15(a)});this.$9.subscribe("/notify_disconnect",function(a){return g.$16(a)});this.connectToIris();return this};b.connectToIris=function(a){a===void 0&&(a=null),a!==null&&(this.$3=c("Int64").fromString(a)),this.$8=!0,this.$9.registerExtraConnectPayloadProvider(this)};b.$13=function(){var a;if(this.$4){if(!this.$3){this.$5.bumpCounter("connect_payload_iris_no_seq_id");return[]}a=this.$17()}else a=this.$18();this.$5.debugTrace("Sending request with MQTT Connect",JSON.stringify({topic:a.topic,payload:a.payload}));return[a]};b.$12=function(){var a;if(this.$4){if(!this.$3){this.$5.bumpCounter("subscribe_to_iris_no_seq_id");return}a=this.$17()}else a=this.$18();this.$5.debugTrace("Sending request",JSON.stringify({topic:a.topic,payload:a.payload}));this.$9.publish(a.topic,a.payload,{qos:1,skipBuffer:!0})};b.$19=function(a){var b=null;try{b=JSON.parse(a)}catch(a){this.$5.logError(a,"Unable to process data")}return b};b.$15=function(a){var b=this.$19(a);if(b==null){this.$5.logWarn("_processTypingData","Unable to process typing data");return}this.$2.forEach(function(a){typeof a.onTypingReceived==="function"&&a.onTypingReceived(b)})};b.addDeltaStreamListener=function(a){this.$2.push(a)};b.$16=function(a){this.$5.logWarn("_handleNotifyDisconnect","Disconnecting reason: "+a),this.$5.bumpCounter("notify_disconnect_"+a),a===d("SyncProtocolConstants").IRIS_CURSOR_LIMIT&&this.$20(a)};b.$20=function(a){this.$5.bumpCounter(a+"_request"),this.$4=null,this.$8=!1,this.$9.unregisterExtraConnectPayloadProvider(this),this.$2.forEach(function(b){return b.onStreamDisconnect(a)})};b.$14=function(a){a=this.$19(a);if(a==null){this.$5.logWarn("_processDeltas","Unable to process delta");return}var b={syncToken:a.syncToken,entityId:a.queueEntityId,errorCode:a.errorCode,firstSeqId:a.firstDeltaSeqId,lastSeqId:a.lastIssuedSeqId};this.$5.debugTrace("Sync data received",JSON.stringify(b));b=this.$1;a.queueEntityId!=null&&a.queueEntityId!=b?this.$5.bumpCounter("delta_for_other_fbid"):a.syncToken?this.$21(a):a.queueEntityId==null?this.$5.bumpCounter("no_fbid"):a.errorCode?this.$22(a.errorCode):this.$23(a)};b.$22=function(a){this.$5.bumpCounter("iris_queue_error."+a),this.$5.logWarn("_handleIrisError","Recevied an error code from sync protocol "+a),a==="ERROR_QUEUE_TEMPORARY_NOT_AVAILABLE"?this.$10():this.$20(a)};b.$21=function(a){var b=this,d=c("Int64").fromString(a.firstDeltaSeqId.toString());(this.$3===null||this.$3!=null&&!this.$3.equals(d))&&this.$5.bumpCounter("initial_sequence_id_mismatch");this.$4=a.syncToken;this.$3=d;this.$5.debugTrace("Sync token received",JSON.stringify({token:this.$4}));this.$9.getConnectionState()==="Connected"?this.$12():this.$9.subscribeChannelEvents({onMQTTStateChanged:function(a){a==="Connected"&&b.$10.reset()}})};b.$23=function(a){var b=a.deltas,d=this.$3;if(b&&d){var e=c("Int64").fromString(a.firstDeltaSeqId.toString());a=c("Int64").fromString(a.lastIssuedSeqId.toString());e.equals(d.add(c("Int64").ONE))?this.$24(e,a,b):e.compare(d)<0?(this.$5.bumpCounter("delta_batch_in_middle"),a.compare(d)>0&&this.$24(d.add(c("Int64").ONE),a,b)):(this.$5.bumpCounter("missing_deltas_get_diffs"),this.$12())}else this.$5.bumpCounter("process_deltas_invalid_state")};b.$24=function(a,b,d){a=a;for(var e=0;e<d.length;e++){var f=d[e],g=f["class"]||"Missing",h={seqId:a.toString(),type:g,status:""},i=1;if(g!="Missing")try{i=this.$25(f,g,a,h)}catch(a){h.status="err:"+a.message}else h.status="no type",this.$5.bumpCounter("missing_delta_type");this.$5.debugTrace("onDeltaReceived",JSON.stringify(h));a=a.add(c("Int64").fromInt(i))}this.$3=b};b.$25=function(a,b,d,e){var f=1,g="";b==="NoOp"&&(f=a.numNoOps||f,g+="n:"+f);a.irisSeqId||(a.irisSeqId=d.toString(),g+="missing seq id");var h=c("Int64").fromString(a.irisSeqId.toString())||d;h.equals(d)?g+=" seqId match":(g+=" seqId mismatch",this.$5.bumpCounter("seq_id_running_id_mismatch"));var i={type:b,payload:a};this.$2.forEach(function(a){return a.onDeltaReceived(i)});e.status=g;return f};b.$18=function(){var a={sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,initial_titan_sequence_id:this.$3&&this.$3.toString(),device_params:this.$6,queue_position:this.$7,client_feature_id:this.$11};return{topic:"/messenger_sync_create_queue",payload:JSON.stringify(a),qos:1}};b.$17=function(){var a={sync_token:this.$4,sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,last_seq_id:this.$3&&this.$3.toString(),client_feature_id:this.$11};return{topic:"/messenger_sync_get_diffs",payload:JSON.stringify(a),qos:1}};return a}();var h=new(c("MercurySingletonProvider"))(a);g["default"]=a}),98);
__d("MMessengerMQTTConnection",["CurrentUser","FBMqttChannel","MMercurySyncDispatcher","MercurySingletonProvider","MqttLogger","SyncProtocolClient","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a,this.$2=c("MqttLogger").getInstance(),this.$3=!1}a.getForFBID=function(a){return h.getForFBID(a)};a.setUp=function(b){var d=b.fbid,e=b.irisSeqID;b.appID;b.endpoint;if(!d||!e)return;b=c("MqttLogger").getInstance();if(!c("CurrentUser").isLoggedInNow()){b.debugTrace("run","User not logged in");b.bumpCounter("mtouch.user_not_loggged_in");return}else b.bumpCounter("mtouch.setup");b=a.getForFBID(d);b.initializeDeltaStream(d,e)};var b=a.prototype;b.initializeDeltaStream=function(a,b){if(this.$3)return;this.$2.bumpCounter("MMessageMQTTConnection.initializeDeltaStream");this.$3=!0;var d=null;c("gkx")("687751")&&(d={accept_pending_deltas:!0});c("SyncProtocolClient").getForFBID(a).init(c("FBMqttChannel"),b,d).addDeltaStreamListener(this)};b.onDeltaReceived=function(a){a.type;a=a.payload;c("MMercurySyncDispatcher").getForFBID(this.$1.toString()).process(a,"mqtt")};b.onStreamDisconnect=function(a){this.$2.bumpCounter("mtouch.stream_disconnect."+a)};return a}();var h=new(c("MercurySingletonProvider"))(a);g["default"]=a}),98);
__d("XBrowserPushRegistrationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/push/permissions/",{})}),null);
__d("MNotificationsUpdatePermissionStatus",["MRequest","XBrowserPushRegistrationController"],(function(a,b,c,d,e,f){"use strict";var g={updateIfNeeded:function(a){if(a.host!==window.location.hostname)return;window.Notification&&window.Notification.permission!==a.state&&g._updateRegistration(window.location.hostname,window.Notification.permission)},_updateRegistration:function(a,c){var d=b("XBrowserPushRegistrationController").getURIBuilder().getURI();d=new(b("MRequest"))(d);d.setData({host:a,state:c});d.setMethod("POST");d.send()}};e.exports=g}),null);
__d("MSplashScreenSwRegistration",["PushRegistration","Run","ServiceWorkerRegistration"],(function(a,b,c,d,e,f,g){function a(a){d("Run").onAfterLoad(function(){c("ServiceWorkerRegistration").registerWorkerIfUnregistered(a)})}function b(){if(c("PushRegistration").pushPermissionIsOn())return;c("ServiceWorkerRegistration").unregisterControllingWorker()}g.register=a;g.unregister=b}),98);